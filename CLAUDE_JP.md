# CLAUDE_JP.md

このファイルは、Claude Code (claude.ai/code) がこのリポジトリでコードを扱う際のガイダンスを提供します。

## プロジェクト概要

42スクールのC++カリキュラムプロジェクトで、C++モジュール00-04を実装します。コードベースは厳密なC++98標準と教育的制約に従い、初心者にオブジェクト指向プログラミングの基礎を教えることを目的としています。

**リポジトリ構造**: モジュール単位のブランチ戦略を持つ単一Gitリポジトリ
**対象ユーザー**: OOPの基礎を学ぶC++初心者
**品質優先度**: 説明的な冗長性より技術的精度とコードの正確性を重視

## ビルドシステム

各演習は一貫した構造の標準Makefileを使用します：

```bash
# 特定の演習に移動（例：cpp00/ex00, cpp01/ex00）
cd cpp01/ex00/

# プロジェクトをビルド
make

# ビルド成果物をクリーン
make clean    # .oファイルを削除
make fclean   # 生成されたすべてのファイルを削除
make re       # クリーンリビルド
```

**標準コンパイラフラグ**: `-Wall -Wextra -Werror -std=c++98`

## 開発環境

### macOS開発環境
- 主要開発環境
- valgrindサポートなし（下記の代替ツールを使用）
- すべてのコードはmacOSで正しくコンパイル・実行される必要がある

### Ubuntu検証環境
- valgrindメモリリーク検出に使用
- GitHub ActionsまたはVirtual Environment経由でアクセス
- 提出前の最終検証環境

### 推奨開発ツール

**静的解析（macOS対応）:**
- `cppcheck`: C/C++静的解析
- `clang-static-analyzer`: Clang内蔵静的アナライザー
- `pc-lint-plus`: プロフェッショナル静的解析（利用可能な場合）

**メモリデバッグ（Ubuntu）:**
- `valgrind --tool=memcheck`: メモリリーク検出
- `valgrind --tool=helgrind`: スレッドエラー検出
- `AddressSanitizer`: `-fsanitize=address`でコンパイル

**コード品質:**
- `clang-format`: コードフォーマット一貫性
- `iwyu` (include-what-you-use): ヘッダー依存関係最適化

## 開発制約

**禁止されているC++機能:**
- C++11+機能（auto、範囲ベースfor、lambda等）
- STLコンテナ（モジュール08まで）
- `using namespace`文（採点ペナルティ: -42）
- `printf()` - 代わりに`std::cout`を使用
- 動的メモリ関数: `malloc()`, `free()`, `*alloc()`
- `friend`キーワード（採点ペナルティ: -42）

**必須実践事項:**
- 警告ゼロでのコンパイル
- C++98標準準拠のみ
- クラスのOrthodox Canonical Form（モジュール02から）
- RAII原則の遵守
- メモリリークなし
- すべてのヘッダーにインクルードガード
- 独立したヘッダーコンパイル

## Gitワークフロー戦略

### ブランチ構造
```
main
├── feature/cpp01-implementation
├── feature/cpp02-implementation
├── feature/cpp03-implementation
├── feature/cpp04-implementation
└── docs/enhance-cpp00-documentation
```

### 並行実装ワークフロー

**フェーズ1: 並行開発**
1. 各モジュールのフィーチャーブランチを同時作成
2. 効率性のため全モジュールを並行実装
3. 最適化より先にコア機能に集中

**フェーズ2: 統合テスト**
1. 完成したモジュールをテストブランチにマージ
2. 全モジュールにわたる包括的テストスイート実行
3. GitHub Actions（Ubuntu環境）経由でメモリリークテスト

**フェーズ3: ドキュメント化・レビュー**
1. 全モジュールの詳細学習ドキュメント作成
2. 詳細フィードバック付き包括的コードレビュー
3. 全品質ゲート通過後にmainにマージ

## アーキテクチャ

### モジュール進行
- `cpp00/`: 名前空間、クラス、メンバ関数、stdioストリーム
  - `ex00/`: 文字列操作とコマンドライン引数
  - `ex01/`: PhoneBookとContactクラスによるクラス設計
  - `ex02/`: Accountクラスによる静的メンバ管理

- `cpp01/`: メモリ割り当て、メンバへのポインタ、参照、switch
- `cpp02/`: アドホック多態性、演算子オーバーロード、Orthodox Canonical Form
- `cpp03/`: 継承概念と仮想関数
- `cpp04/`: サブタイプ多態性、抽象クラス、インターフェース

### クラス設計パターン
- **カプセル化**: 制御されたパブリックアクセスによるプライベートデータ
- **RAII**: Resource Acquisition Is Initialization
- **Orthodox Canonical Form**: デフォルトコンストラクタ、コピーコンストラクタ、代入演算子、デストラクタ
- **静的メンバ管理**: クラスレベルの状態と操作
- **段階的複雑性**: 単純クラスから継承階層まで

## テスト戦略

### 手動テスト（主要）
- **機能テスト**: 全要件の検証
- **境界テスト**: エッジケースと制限
- **エラーハンドリング**: 無効入力とエラー条件
- **対話テスト**: PhoneBookのようなCLIプログラム
- **クロスプラットフォーム**: macOS開発、Ubuntu検証

### 自動検証（GitHub経由Ubuntu）
```bash
# メモリリーク検出
valgrind --leak-check=full --show-leak-kinds=all ./program

# 静的解析
cppcheck --enable=all --std=c++98 src/

# コンパイル検証
g++ -Wall -Wextra -Werror -std=c++98 -fsanitize=address
```

## ドキュメント標準

### コードドキュメント要件

**ヘッダーコメント（全ファイル）:**
```cpp
/* ************************************************************************** */
/*                                                                            */
/*   [filename]                               :+:      :+:    :+:   */
/*                                        +:+ +:+         +:+     */
/*   By: [author] <[email]>                +#+  +:+       +#+        */
/*                                        +#+#+#+#+#+   +#+           */
/*   Created: [date] by [author]             #+#    #+#             */
/*   Updated: [date] by [author]            ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */
```

**詳細コードコメント（学習用）:**
```cpp
// コンストラクタ: 空の連絡先配列でPhoneBookを初期化
// パラメータ: なし
// 学習ポイント: C++98でのデフォルトコンストラクタ実装
PhoneBook::PhoneBook() {
    // 連絡先数を0に初期化
    // C++98注意: 単純型にはメンバ初期化リストを使用しない
    this->_contactCount = 0;
    
    // 循環バッファ動作のため最古インデックスを初期化
    // 設計判断: 最古の連絡先を置き換えるために循環バッファを使用
    this->_oldestContactIndex = 0;
}
```

### 学習ドキュメント構造

**モジュール学習レポートテンプレート（`docs/cpp0X-learning-report-jp.md`）:**
```markdown
# C++ モジュール 0X 学習レポート

## 学習目標
- [導入される特定のC++概念]
- [実証されるOOP原則]
- [42スクールカリキュラムの目標]

## 扱われる技術概念
### [概念1]
- **定義**: [明確な説明]
- **実装**: [詳細コメント付きコード例]
- **よくある落とし穴**: [初心者が避けるべきこと]
- **ベストプラクティス**: [推奨アプローチ]

## 実装時の課題
### [課題1]
- **問題**: [課題の説明]
- **解決策**: [どのように解決したか]
- **学習**: [これから何を学んだか]

## コードレビューチェックリスト
- [ ] [このモジュール特有のレビューポイント]
- [ ] [技術要件の検証]
- [ ] [42スクール準拠チェック]

## さらなる学習のための発展トピック
- [後で探索する関連概念]
- [将来のモジュールとの接続]
```

## コードレビューガイドライン

### セルフレビューチェックリスト

**コンパイル・基本機能:**
- [ ] `-Wall -Wextra -Werror -std=c++98`でコンパイル
- [ ] 実行時エラーやクラッシュなし
- [ ] 全必要機能が実装済み
- [ ] プログラムが期待する出力を生成

**メモリ管理:**
- [ ] メモリリークなし（Ubuntuでvalgrindにより検証）
- [ ] 禁止された割り当て関数の未使用
- [ ] 適切なRAII実装
- [ ] 可能な限りスタックベースメモリ管理

**C++98準拠:**
- [ ] C++11+機能未使用
- [ ] 禁止されたSTLコンテナ未使用
- [ ] `using namespace`文未使用
- [ ] `friend`キーワード未使用

**コード品質:**
- [ ] 明確で読みやすい変数・関数名
- [ ] 一貫したコーディングスタイル
- [ ] 学習目的の適切なコメント
- [ ] 論理的なコード組織

### 第三者レビュー重点領域

**アーキテクチャレビュー:**
- [ ] **クラス設計**: 適切なカプセル化とデータ隠蔽
- [ ] **インターフェース設計**: 清潔なパブリックインターフェース、最小結合
- [ ] **SOLID原則**: 単一責任、適切な抽象化
- [ ] **エラーハンドリング**: 堅牢なエラー検出と報告

**実装レビュー:**
- [ ] **Orthodox Canonical Form**: 必要時の適切な実装
- [ ] **リソース管理**: 正しいコンストラクタ/デストラクタペア
- [ ] **例外安全性**: 基本的例外安全性保証
- [ ] **パフォーマンス**: 効率的なアルゴリズムとデータ構造

**教育価値レビュー:**
- [ ] **学習進行**: モジュールレベルに適した複雑性
- [ ] **概念実証**: 必要概念の明確な例
- [ ] **コードコメント**: 初心者への有用な説明
- [ ] **ドキュメント品質**: 完全で正確な学習資料

### レビュー重要度レベル

**クリティカル（必修正）:**
- コンパイル失敗
- メモリリーク
- 禁止機能使用
- 不正なプログラム動作

**メジャー（修正推奨）:**
- 不十分なエラーハンドリング
- 非効率な実装
- Orthodox Canonical Form不備
- 不十分なドキュメント

**マイナー（修正検討）:**
- スタイル不整合
- 最適でないが動作するソリューション
- 高度最適化の欠如

## ファイル構成

```
cpp/
├── cpp00/                  # モジュール00（実装済み）
│   ├── ex00/              # 演習ディレクトリ
│   ├── ex01/
│   ├── ex02/
│   └── docs/              # 強化ドキュメント
├── cpp01/                  # モジュール01（実装予定）
│   ├── ex00/
│   ├── ex01/
│   ├── docs/
│   └── cpp01.pdf
├── cpp02/                  # モジュール02（実装予定）
├── cpp03/                  # モジュール03（実装予定）
├── cpp04/                  # モジュール04（実装予定）
├── .gitignore             # ビルド成果物、IDEファイル
├── README.md              # プロジェクト概要
├── CLAUDE.md              # 英語版ガイド
└── CLAUDE_JP.md           # このファイル（日本語版）
```

**ファイル命名規則:**
- クラス: `ClassName.hpp`, `ClassName.cpp`
- 実行ファイル: 説明的な名前（例：`phonebook`, `megaphone`）
- ドキュメント: `docs/`サブディレクトリにモジュール固有

## 品質保証コマンド

### 開発コマンド（macOS）
```bash
# 静的解析
cppcheck --enable=all --std=c++98 --suppress=missingIncludeSystem src/

# 追加チェック付きコンパイル
clang++ -Wall -Wextra -Werror -std=c++98 -Weverything -Wno-c++98-compat-pedantic

# コードフォーマット
clang-format -i -style="{BasedOnStyle: Google, IndentWidth: 4, TabWidth: 4}" *.cpp *.hpp
```

### 検証コマンド（Ubuntu）
```bash
# メモリリーク検出
valgrind --leak-check=full --show-leak-kinds=all --track-origins=yes ./program

# スレッド安全性（該当する場合）
valgrind --tool=helgrind ./program

# アドレスサニタイザーコンパイル
g++ -Wall -Wextra -Werror -std=c++98 -fsanitize=address -g -O1
```

## 成功基準

**技術要件:**
- コンパイル警告ゼロ
- メモリリークゼロ
- 機能要件100%準拠
- C++98標準遵守

**教育要件:**
- 包括的学習ドキュメント
- 初心者向け詳細コードコメント
- 段階的スキル実証
- 明確な概念説明

**プロセス要件:**
- 適切なGitワークフロー遵守
- 徹底したセルフ・ピアレビュー
- 両プラットフォームでの完全テスト
- プロフェッショナルドキュメント標準